<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.145.0"><script src="/blogs/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=blogs/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Learning Loop</title>

<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/blogs/">
<link crossorigin="anonymous" href="/blogs/assets/css/stylesheet.3100c559f5e5f9a03f24d0f501a11025c11322dfc9520791d926b4086ca75994.css" integrity="sha256-MQDFWfXl&#43;aA/JND1AaEQJcETIt/JUgeR2Sa0CGynWZQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/blogs/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/blogs/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/blogs/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/blogs/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/blogs/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/blogs/index.xml">
<link rel="alternate" type="application/json" href="http://localhost:1313/blogs/index.json">
<link rel="alternate" hreflang="en" href="http://localhost:1313/blogs/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript> 
<script
  data-goatcounter="https://ttharsh.goatcounter.com/count"
  async
  src="//gc.zgo.at/count.js"
></script>


</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/blogs/" accesskey="h" title="Learning Loop (Alt + H)">Learning Loop</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main"> 
<article class="first-entry home-info">
    <header class="entry-header">
        <h1>Hi There üëã</h1>
    </header>
    <div class="entry-content">
        Hi, My name is Harsh, Welcome to my blog. Here I share whatever new things I learn or my past learnings while exploring system architecture, database internals, observability, and backend infrastructure‚Äîone deep dive at a time.
    </div>
    <footer class="entry-footer">
        <div class="social-icons" >
    <a href="https://github.com/harshrai654" target="_blank" rel="noopener noreferrer me"
        title="Github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
    </a>
    <a href="https://x.com/harshrai3" target="_blank" rel="noopener noreferrer me"
        title="Twitter">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
    </a>
</div>

    </footer>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Building Fault Tolerant KV Storage System - Part 2
    </h2>
  </header>
  <div class="entry-content">
    <p>%% Explain sequence:
Concept of commit Index, lastApplied Index in RAFT state Explain setupLeader, lastContactFromLeader - how it helps in preventing election. A egenral flow of request from client with Start continuing with replicate method introduces in setpLeader and how CV helps in signalling for heartbeat or logs How AppendEntries as a single RPC does the jobs of both heartbeat and log replication How leader maintains next and match index and what does that mean Explain everything about replicate and AppendEntries RPC How Log correction happen reconileLogs and how we use optimisation there to reduce RPC trips Explain how applier runs on different thtread why it runs on different thread and how CV help their %% We previously discussed replicated state machines, leader election in the RAFT consensus algorithm, and log-based state maintenance. Now, we‚Äôll focus on log replication across peer servers. We‚Äôll also examine how RAFT ensures that the same commands are applied to the state machine at a given log index on every peer, because of the leader‚Äôs one-way log distribution to followers.
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-10-04 16:16:17 +0530 IST'>October 4, 2025</span>&nbsp;¬∑&nbsp;10 min</footer>
  <a class="entry-link" aria-label="post link to Building Fault Tolerant KV Storage System - Part 2" href="http://localhost:1313/blogs/building-fault-tolerant-kv-storage-system---part-2/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Building Fault Tolerant KV Storage System - Part 1
    </h2>
  </header>
  <div class="entry-content">
    <p>This blog post is part of a series detailing my implementation of a fault-tolerant key-value server using the RAFT consensus protocol. Before diving into RAFT and its mechanics, it‚Äôs crucial to grasp the concept of a replicated state machine and its significance in building systems that are both fault-tolerant and highly available.
Replicated State Machine A replicated state machine is essentially a collection of identical machines working together. One machine acts as the ‚Äúmaster,‚Äù handling client requests and dictating the system‚Äôs operations. The other machines, the ‚Äúreplicas,‚Äù diligently copy the master‚Äôs state. This ‚Äústate‚Äù encompasses all the data necessary for the system to function correctly, remembering the effects of previous operations. Think of a key-value store: the state would be the key-value pairs themselves, replicated across all machines to maintain consistency and resilience. Having the master‚Äôs state copied across multiple machines enables us to use these replicas in several ways. They can take over as the new master if the original fails, or handle read operations to reduce the load on the master. Because the state is copied across machines, network issues like latency, packet loss, and packet reordering significantly affect how closely a replica‚Äôs state matches the master‚Äôs. The difference between the master‚Äôs (most up-to-date) state and a replica‚Äôs state is known as replication lag. Generally, we aim to minimize this lag, and different systems offer varying levels of consistency (which we will discuss later when covering replication in RAFT).
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-10-03 20:38:34 +0530 IST'>October 3, 2025</span>&nbsp;¬∑&nbsp;23 min</footer>
  <a class="entry-link" aria-label="post link to Building Fault Tolerant KV Storage System - Part 1" href="http://localhost:1313/blogs/building-fault-tolerant-kv-storage-system---part-1/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Map Reduce
    </h2>
  </header>
  <div class="entry-content">
    <p>This article shares learnings from Google‚Äôs influential MapReduce paper and explores the challenges encountered while implementing a simplified version. Our system uses multiple worker processes, running on a single¬†machine and communicating via RPC, to mimic key aspects of a distributed environment.
What is Map-Reduce At its core, MapReduce is a programming model and an associated¬†framework for processing and generating massive datasets using a parallel, distributed algorithm, typically on a cluster of computers. You might already be familiar¬†with¬†map¬†and¬†reduce¬†operations from functional programming languages. For instance, in JavaScript,¬†array.map()¬†transforms¬†each element of an array independently based on a¬†mapper¬†function, while¬†array.reduce()¬†iterates through an array, applying a¬†reducer¬†function to accumulate its elements into a single output value (e.g., a sum, or¬†a new, aggregated object).
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-05-31 12:49:54 +0530 IST'>May 31, 2025</span>&nbsp;¬∑&nbsp;34 min</footer>
  <a class="entry-link" aria-label="post link to Map Reduce" href="http://localhost:1313/blogs/map-reduce/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Debugging Redis Latency
    </h2>
  </header>
  <div class="entry-content">
    <p>This article is about how at work we solved the issue of high response time while executing Redis commands from Node.js server to a Redis compatible database known as dragonfly.
Background After introducing metrics to our Node.js service, we started recording the overall response time whenever a Redis command was executed. We had a wrapper service around a Redis driver known as ioredis for interacting with our Redis-compatible database. Once we set up Grafana dashboards for metrics like cache latency, we saw unusually high p99 latency numbers, close to 200ms. This is a very large number, especially considering the underlying database query itself typically takes less than 10ms to complete. To understand why this latency was so high, we needed more detailed insight than metrics alone could provide. As part of a broader effort to set up our observability stack, I had been exploring various tracing solutions ‚Äì options ranged from open-source SDKs (OpenTelemetry Node.js SDK) with a self-deployed trace backend, to third-party managed solutions (Datadog, Middleware, etc.). For this investigation, we decided to proceed with a self-hosted Grafana Tempo instance to test the setup and feasibility. (So far, the setup is working great, and I‚Äôm planning a detailed blog post on our observability architecture soon). With tracing set up, we could get a waterfall view of the path taken by the service while responding to things like HTTP requests or event processing, which we hoped would pinpoint the source of the delay in our Redis command execution.
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-04-06 14:21:54 +0530 IST'>April 6, 2025</span>&nbsp;¬∑&nbsp;11 min</footer>
  <a class="entry-link" aria-label="post link to Debugging Redis Latency" href="http://localhost:1313/blogs/debugging-redis-latency/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Socket File Descriptor and TCP connections
    </h2>
  </header>
  <div class="entry-content">
    <p>Socket File Descriptors and Their Kernel Structures A socket is a special type of file descriptor (FD) in Linux, represented as socket:[inode]. Unlike regular file FDs, socket FDs point to in-memory kernel structures, not disk inodes. The /proc/&lt;pid&gt;/fd directory lists all FDs for a process, including sockets. The inode number of a socket can be used to inspect its details via tools like ss and /proc/net/tcp. Example: Checking Open FDs for Process 216 ls -l /proc/216/fd Output:
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-03-02 16:15:01 +0530 IST'>March 2, 2025</span>&nbsp;¬∑&nbsp;4 min</footer>
  <a class="entry-link" aria-label="post link to Socket File Descriptor and TCP connections" href="http://localhost:1313/blogs/socket-file-descriptor-and-tcp-connections/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Understanding Inodes and Disk Layout
    </h2>
  </header>
  <div class="entry-content">
    <p>Overall Organization Of Data In Disks Assuming we have a 256KB disk.
Disk Blocks: The basic units of storage on the disk, each 4 KB in size. The disk is divided into these blocks, numbered from 0 to N-1 (where N is the total number of blocks). Inode Bitmap (i): Block 1; a bitmap tracking which inodes are free (0) or in-use (1). Data Bitmap (d): Block 2; a bitmap tracking which data blocks are free (0) or allocated (1). Inode Table (I): Blocks 3-7; an array of inodes, where each inode (256 bytes) holds metadata about a file, like size, permissions, and pointers to data blocks. 5 blocks of 4KB will contain 80 256 byte inode strutures. Data Region (D): Blocks 8-63; the largest section, storing the actual contents of files and directories. Inode Every inode has a unique identifier called an inode number (or i-number). This number acts like a file‚Äôs address in the file system, allowing the operating system to quickly locate its inode. For example:
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-03-01 20:41:00 +0000 UTC'>March 1, 2025</span>&nbsp;¬∑&nbsp;6 min</footer>
  <a class="entry-link" aria-label="post link to Understanding Inodes and Disk Layout" href="http://localhost:1313/blogs/file-system-implementation/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Files And Directories
    </h2>
  </header>
  <div class="entry-content">
    <p>Files and directories File systems virtualize persistent storage (e.g., hard drives, SSDs) into user-friendly files and directories, adding a third pillar to OS abstractions (processes for CPU, address spaces for memory).
File Paths and System Calls Files are organized in a tree-like directory structure, starting from the root (/). A file‚Äôs location is identified by its pathname (e.g., /home/user/file.txt). To interact with files, processes use system calls:
open(path, flags): Opens a file and returns a file descriptor (fd). read(fd, buffer, size): Reads data from the file into a buffer using the fd. write(fd, buffer, size): Writes data to the file via the fd. close(fd): Closes the file, freeing the fd. File Descriptors A file descriptor is a small integer, unique to each process, that identifies an open file. When a process calls open(), the operating system assigns it the next available fd (e.g., 3, 4, etc.). Every process starts with three default fds:
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-02-23 20:41:00 +0000 UTC'>February 23, 2025</span>&nbsp;¬∑&nbsp;11 min</footer>
  <a class="entry-link" aria-label="post link to Files And Directories" href="http://localhost:1313/blogs/files-and-directories/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">RAID (Redundant array of inexpensive disk)
    </h2>
  </header>
  <div class="entry-content">
    <p>RAID Disks Three axes on which disks are analysed
Capacity - How much capacity is needed to store X bytes of data Reliability - How much fault-tolerant is the disk Performance - Read and write speeds (Sequential and random) To make a logical disk (comprising set of physical disks) reliable we need replication, so there is tradeoff with capacity and performance (write amplification) When we talk about collection of physical disks representing one single logical disk we should know that there would be small compute and some non-volatile RAM also included to fully complete the disk controller component. This RAM is also used for WAL for faster writes similar to #Database In a way this set of disks also have challenges similar to distributes databases.
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-02-13 20:25:14 +0530 IST'>February 13, 2025</span>&nbsp;¬∑&nbsp;7 min</footer>
  <a class="entry-link" aria-label="post link to RAID (Redundant array of inexpensive disk)" href="http://localhost:1313/blogs/raid-redundant-array-of-inexpensive-disk/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Multilevel Page table
    </h2>
  </header>
  <div class="entry-content">
    <p>Segmented Page Table Page table can grow large for a 32-bit address space and 4 KB page size we will be using 20 bits for virtual page number resulting in 2^20 bytes (i.e. 4MB of page table) for a single page table and each process will have its own page table so it is possible that we will be storing ~100sMB for page table alone which is not good. For above page table with 4 bits for VPN (Virtual page number) we can see that only VPN 0,4,14 and 15 are valid i.e. pointing to a PFN (Physical Frame Number) other PTEs (Page table entry) are just taking up space which is not used. We can use segmentation here with base and bound registers for each page table to only store valid PTE in the table. This will again split the virtual address to also contain the segment bits to identify which segment the address belongs to (code, heap or stack). Instead of using Base Page Table Register to query page table we will now be using Base Page Table Register [Segment] to get page table physical address for a given segment.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-11-26 20:29:34 +0530 IST'>November 26, 2024</span>&nbsp;¬∑&nbsp;4 min</footer>
  <a class="entry-link" aria-label="post link to Multilevel Page table" href="http://localhost:1313/blogs/multilevel-page-table/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">TLB
    </h2>
  </header>
  <div class="entry-content">
    <p>TLB Translation look-aside buffer is a CPU cache which is generally small but since it is closer to CPU a TLB hit results in address translation to happen in 1-5 CPU cycles.
CPU Cycle Time taken by CPU to fully execute an instruction, while CPU frequency refers to the number of these cycles that occur per second
A TLB hit means for given virtual address the physical frame number was found in the TLB cache. A TLB hit will benefit all the address that lie on the same page. In the above given image page size is 16 bytes, so 4 INT variables can be saved in a single page, so a TLB hit of VPN 07 will serve address translation for VPN = 07 &#43; page of offset of 0, 4,8 and 12 byte. This type of caching is benefitted from spatial locality of data where a cache hit results in cache hits for surrounding data as well. If we cache data and other data points which are more probable to get accessed in the same time frame (like loop variables etc) then such caching is benefitted from Temporal locality.
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-11-20 22:26:06 +0530 IST'>November 20, 2024</span>&nbsp;¬∑&nbsp;2 min</footer>
  <a class="entry-link" aria-label="post link to TLB" href="http://localhost:1313/blogs/tlb/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="http://localhost:1313/blogs/page/2/">Next&nbsp;&nbsp;¬ª
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/blogs/">Learning Loop</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
